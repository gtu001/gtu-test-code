# 自訂name

$ ./elasticsearch -Ecluster.name=my_cluster_name -Enode.name=my_node_name


------------------------------------------------------------------------------------
# 看健康指數

$ curl -X GET "localhost:9200/_cat/health?v"


------------------------------------------------------------------------------------
# 顯示node

$ curl -X GET "localhost:9200/_cat/nodes?v"


------------------------------------------------------------------------------------
# 顯示index (只有一行表示沒index)

$ curl -X GET "localhost:9200/_cat/indices?v"

health status index    uuid                   pri rep docs.count docs.deleted store.size pri.store.size
yellow open   customer 95SQ4TSUT7mWBT7VNHH67A   5   1          0            0       260b           260b

PS: 5 shards , 1 replica , 0 documents 


------------------------------------------------------------------------------------
# 建立index (index 名為 customer)

$ curl -X PUT "localhost:9200/customer?pretty"


------------------------------------------------------------------------------------
# 顏色指示

    Green - everything is good (cluster is fully functional)
    Yellow - all data is available but some replicas are not yet allocated (cluster is fully functional)
    Red - some data is not available for whatever reason (cluster is partially functional) 
    
    
------------------------------------------------------------------------------------
# 加入 doc 進  index (index 名為 customer)

$ curl -X PUT "localhost:9200/customer/_doc/1?pretty" -H 'Content-Type: application/json' -d'
{
  "name": "John Doe"
}
'

PS : /_doc/[1] --> 若想要不給id 要用 POST

------------------------------------------------------------------------------------
# 取回  doc

$ curl -X GET "localhost:9200/customer/_doc/1?pretty"

Ps: /_doc/[1] <-- id, found : (true|false) 是否找到


------------------------------------------------------------------------------------
# 刪除 doc

$ curl -X DELETE "localhost:9200/customer?pretty"


------------------------------------------------------------------------------------
# 更新 doc

$ curl -X POST "localhost:9200/customer/_doc/QlmOhGUBXFaJibnYQmjW/_update?pretty" -H 'Content-Type: application/json' -d'
{
  "doc": { "name": "Jane Doe Ver2", "age": 20 }
}
'

PS : QlmOhGUBXFaJibnYQmjW --> id

=========================================
# 更新 doc with script

$ curl -X POST "localhost:9200/customer/_doc/QlmOhGUBXFaJibnYQmjW/_update?pretty" -H 'Content-Type: application/json' -d'
{
  "script" : "ctx._source.age += 5"
}
'

Ps : 更新 age = age + 5

=========================================
# 更新 doc 改 id

$ curl -X POST "localhost:9200/customer/_doc/CtTejmUBQbs41qunAcE_/_update?pretty" -H 'Content-Type: application/json' -d'
      {
        "_index" : "customer",
        "_type" : "_doc",
        "_id" : "1",
        "_score" : 1.0
      }
'


------------------------------------------------------------------------------------
# 查詢 doc

$ curl -X GET "localhost:9200/customer/_search?pretty=true&q=*:*"
PS :　預設10筆

$ curl -X GET "localhost:9200/customer/_search?pretty=true&q=*:*&size=<number here>"
PS :　自訂筆數

$ curl -XGET 'localhost:9200/customer/_search?search_type=scan&scroll=10m&size=50' -d '
{
    "query" : {
        "match_all" : {}
    }
}'

$ curl -X GET "localhost:9200/customer/_search?q=*&sort=account_number:asc&pretty"


$ curl -X GET "localhost:9200/bank/_search" -H 'Content-Type: application/json' -d'
{
  "query": { "match_all": {} },
  "sort": [
    { "account_number": "asc" }
  ],
  "from": 10, --第幾筆開始 default 10
  "size": 10  --抓10比 default 10
}
'



------------------------------------------------------------------------------------
# 刪除 doc

$ curl -X DELETE "localhost:9200/customer/_doc/2?pretty"


------------------------------------------------------------------------------------
# 批次新增

$ curl -X POST "localhost:9200/customer/_doc/_bulk?pretty" -H 'Content-Type: application/json' -d'
{"index":{"_id":"1"}}
{"name": "John Doe" }
{"index":{"_id":"2"}}
{"name": "Jane Doe" }
'


------------------------------------------------------------------------------------
# 批次更新

$ curl -X POST "localhost:9200/customer/_doc/_bulk?pretty" -H 'Content-Type: application/json' -d'
{"update":{"_id":"1"}}
{"doc": { "name": "John Doe becomes Jane Doe" } }
{"delete":{"_id":"2"}}
'


------------------------------------------------------------------------------------
# 讀取批次黨

curl -i -XPOST  "localhost:9200/customer/_doc/_bulk?pretty&refresh" \
 -H "Content-Type: application/json"  \
 --data-binary "@/C/Users/wistronits/Desktop/test.json"

格式必須為 一行 action meta data, 一行 source 物件 , 請參照 bulk_insert.json


------------------------------------------------------------------------------------

  


------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------
------------------------------------------------------------------------------------